import { NIP98 } from "./NIP98.js";
import { N64 } from "./utils/N64.js";
/** Wraps a fetch request with NIP98 authentication */ export class NIP98Client {
  signer;
  customFetch;
  constructor(opts){
    this.signer = opts.signer;
    this.customFetch = opts.fetch ?? globalThis.fetch.bind(globalThis);
  }
  /** Performs a fetch request with NIP98 authentication */ async fetch(input, init) {
    // Normalize to a Request object
    const request = new Request(input, init);
    // Create the NIP98 token
    const template = await NIP98.template(request);
    const event = await this.signer.signEvent(template);
    const token = N64.encodeEvent(event);
    // Add the Authorization header
    request.headers.set('Authorization', `Nostr ${token}`);
    // Call the custom fetch function
    return this.customFetch(request);
  }
}
//# sourceMappingURL=NIP98Client.js.map